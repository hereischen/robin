{% extends 'base.html' %}

{% load staticfiles %}

{% block title %}Robin{% endblock %}


{% block body_block %}

<!--     <div class="jumbotron">
        <h3>Theme example</h3>
    </div>
 -->
 <div v-if="!hasRes" transition="expand" v-cloak>
    <div class="page-header">
          <h1>Repositories</h1>
    </div>
    <h2>repos</h2>
    <div class="row">
        <div class="col-md-12">
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Repo Owner</th>
                        <th>Repo Name</th>
                        <th>Pendings</th>
                    </tr>
                </thead>
                <tbody>
                    <tr v-for="repo in repoData.repos">
                        <td class="left"><input type="checkbox" v-model="repo.checked" @click="chooseRepo(repo)"> ${repo.id}</td>
                        <td>${repo.owner}</td>
                        <td>${repo.repo}</td>
                        <td><button id="p-btn${repo.id}" type="button" class="btn btn-xs btn-primary" @click="showPending(repo)">Show</button></td>
                    </tr>
                </tbody>
            </table>
        </div>

     <!--    <div class="col-md-6">
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Repo Owner</th>
                        <th>Repo Name</th>
                    </tr>
                </thead>
                <tbody>
                    <tr v-for="team in teamData.teams">
                        <td class="left"><input type="checkbox" v-model="team.checked" @click="chooseTeam(team)"> ${teamData.teams.indexOf(team) + 1}</td>
                        <td>${team.team_name}</td>
                        <td>${team.team_code}</td>
                    </tr>
                </tbody>
            </table>
        </div> -->
    </div> 
    <!-- class="row" -->

        <div id="pending-patchs" style="display:none;" >
            <div v-if="pendingData.count>0" transition="expand" v-cloak>
                <!-- <div class="alert alert-warning" role="alert"> -->
                    <div class="col-md-12">
                        <table class="table table-bordered">
                            <thead>
                                <tr>
                                    <th>Patch No.</th>
                                    <th>Title</th>
                                    <th>Author</th>
                                    <th>Last Updated</th>
                                    <th>Total Pending</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="pendingPatch in pendingData.pendingPatchs">
                                    <td>${pendingPatch.patch_number}</td>
                                    <td>${pendingPatch.patch_title}</td>
                                    <td>${pendingPatch.author}</td>
                                    <td>${pendingPatch.last_updated} day(s)</td>
                                    <td>${pendingPatch.total_pending} day(s)</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                <!-- </div> -->
            </div>

            <div v-else>
                <div class="alert alert-success" role="alert">
                There is no pending patchs in this repository.
                </div>
            </div>
        </div>
  
 

    <!-- ==================================================nav tab -->
    <h2>Teams</h2>
    <hr>
    <ul class="nav nav-tabs" >
        <li class="active"><a data-toggle="tab" href="#home">Home</a></li>
        <li v-for="team in teamData.teams"><a data-toggle="tab" href="#${team.team_name}">${team.team_name}</a></li>
    </ul>

    <div class="tab-content">
        <div id="home" class="tab-pane fade in active">
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Team Name</th>
                        <!-- <th>Team Code</th> -->
                        <th>Number of Members</th>
                    </tr>
                </thead>
                <tbody>
                    <tr v-for="team in teamData.teams">
                        <td class="left"><input type="checkbox" v-model="team.checked" @click="chooseTeam(team)"> ${teamData.teams.indexOf(team) + 1}</td>
                        <td>${team.team_name}</td>
                        <!-- <td>${team.team_code}</td> -->
                        <td>${team.members.length}</td>
                    <!--   <td>
                          <button type="button" class="btn btn-primary" @click="settle(product)">查询</button>
                      </td> -->
                    </tr>
                </tbody>
            </table>
            <div class="alert alert-${alertType}" role="alert" v-show="msg.length >0" v-cloak>
            <p>${msg}</p>
            </div>
            <button class="btn btn-primary" style="width: 100%;" v-on:click="teamStats()">show</button>
        </div>
        <div v-for="team in teamData.teams" id="${team.team_name}" class="tab-pane fade">
            <h3>Menu 1</h3>
            <p>Some content in menu 1.</p>
        </div>
<!--         <div id="${team.team_name}" class="tab-pane fade">
            <h3>Menu 2</h3>
            <p>Some content in menu 2.</p>
        </div> -->
    </div>
    <!-- ==================================================nav tab -->




<!--   <h2>Teams</h2>
  <div class="panel-group" v-for="team in teamData.teams">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h4 class="panel-title">
          <a data-toggle="collapse" href="#collapse1"> ${team.team_name}</a>
        </h4>
      </div>
      <div id="collapse1" class="panel-collapse collapse">
        <ul class="list-group">
          <li class="list-group-item">One</li>
          <li class="list-group-item">Two</li>
          <li class="list-group-item">Three</li>
        </ul>
        <div class="panel-footer">Footer</div>
      </div>
    </div>
  </div> -->
  <!-- ============================= -->

      <!-- Modal -->
    <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="myModalLabel">Statistics</h4>
                </div>
                <div class="modal-body">
                         <table class="table">
                         <!-- !!!!!! -->
                            <tr v-if="!settleAllState">
                                <td>Repo Name:</td>
                                <td style="text-align: left"><span v-for="item in repoTmp" style="margin-right: 5px;">${item.repo}</span></td>
                                <td>Team Name:</td>
                                <td style="text-align: left"><span v-for="item in teamTmp" style="margin-right: 5px;">${item.team_name}</span>
                                </td>
                            </tr>
                         <!--     <tr v-else>
                                <p>所有商品</p>
                            </tr> -->
                            <tr>
                                <td>Start From:</td>
                                <td style="text-align: left">
                                    <input class="input" id="start_date" v-model="beginTime">
                                </td>
                                <td>End Until:</td>
                                <td style="text-align: left">
                                    <input class="input" id="end_date" v-model="endTime">
                                </td>
                            </tr>
                        </table>
                        <form>
                          <input type="radio" name="category" value="commits" v-model="category" checked> 
                          <span class="label label-default">Commits</span>
                          <input type="radio" name="category" value="comments" v-model="category" > 
                          <span class="label label-default">Comments</span>
                          <input type="radio" name="category" value="closedPatchs" v-model="category" > 
                          <span class="label label-default">Closed Patchs</span>
                        </form>

                        <div class="alert alert-${alertType}" role="alert" v-show="msg.length >0" v-cloak>
                            <p>${msg}</p>
                        </div>
                    </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-danger" @click="submit">Submit</button>
                </div>
<!--                 <div class="progress" v-if="progressWidth != '0%'">
                    <div class="progress-bar progress-bar-success progress-bar-striped" role="progressbar" aria-valuenow="40" aria-valuemin="0" aria-valuemax="100" :style="{width: progressWidth}">
                        <span class="sr-only">40% Complete (success)</span>
                    </div>
                </div> -->
            </div>
        </div>
    </div>
</div>
  <!-- ============================= -->
<!-- ============================= res =============================-->
<div v-if="hasRes" transition="expand" v-cloak>
    <div v-if="category == 'closedPatchs'">
        <h2>Cloesd Patchs</h2>
        <hr>
        <h5>${resData.count} in total</h5>
        <table class="table table-bordered" >
            <thead>
                <!-- <tr>
                <th>${resData.count} in total</th>
                </tr> -->
                <tr>
                    <th>Patch No.</th>
                    <th>Patch Title</th>
                    <th>Is Merged</th>
                    <th>Author</th>
                    <th>Commits</th>
                    <th>Additions</th>
                    <th>Deletions</th>
                    <th>Changed Files</th>
                    <th>Closed at</th>
                </tr>
            </thead>
            <tbody>
                <tr v-for="item in resData.results">
                    <!-- <td class="left"><input type="checkbox" v-model="repo.checked" @click="chooseRepo(repo)"> ${repo.id}</td> -->
                    <td>${item.patch_number}</td>
                    <td>${item.patch_title}</td>
                    <td>${item.pull_merged}</td>
                    <td>${item.author}</td>
                    <td>${item.commits}</td>
                    <td>${item.additions}</td>
                    <td>${item.deletions}</td>
                    <td>${item.changed_files}</td>
                    <td>${item.closed_at}</td>
                    <!-- <td><button id="p-btn${repo.id}" type="button" class="btn btn-xs btn-primary" @click="showPending(repo)">Show</button></td> -->
                </tr>
            </tbody>
        </table>
    </div>
</div>
<!-- ============================= res =============================-->



    


{% endblock %}

{% block script %}
    <script src="{% static 'js/lodash.min.js' %}"></script>
    <script src="{% static 'js/index.js' %}"></script>
{% endblock %}